var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();window.requestAnimationFrame||(window.requestAnimationFrame=window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame),window.cancelAnimationFrame||(window.cancelAnimationFrame=window.mozCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame);!function(e){!function(e){var t=function(){function e(){this.handlers={}}return e.prototype.on=function(e,t){this.handlers[e]=this.handlers[e]||[],this.handlers[e].push(t)},e.prototype.off=function(e,t){this.handlers[e]&&-1!==this.handlers[e].indexOf(t)&&(this.handlers[e][this.handlers[e].indexOf(t)]=function(){})},e.prototype.emit=function(e,t){this.handlers[e]&&this.handlers[e].forEach(function(e){return e(t)})},e.prototype.clean=function(){this.handlers={}},e}();e.EventEmiter=t}(e.event||(e.event={}))}(emloader||(emloader={}));!function(e){!function(e){var t=function(){function e(){}return e.backspace=8,e.tab=9,e.enter=13,e.shift=16,e.ctrl=17,e.alt=18,e.pauseBreak=19,e.capsLock=20,e.escape=27,e.space=32,e.pageup=33,e.pagedown=34,e.end=35,e.home=36,e.leftarrow=37,e.uparrow=38,e.rightarrow=39,e.downarrow=40,e.insert=45,e.delete=46,e.digit0=48,e.digit1=49,e.digit2=50,e.digit3=51,e.digit4=52,e.digit5=53,e.digit6=54,e.digit7=55,e.digit8=56,e.digit9=57,e.a=65,e.b=66,e.c=67,e.d=68,e.e=69,e.f=70,e.g=71,e.h=72,e.i=73,e.j=74,e.k=75,e.l=76,e.m=77,e.n=78,e.o=79,e.p=80,e.q=81,e.r=82,e.s=83,e.t=84,e.u=85,e.v=86,e.w=87,e.x=88,e.y=89,e.z=90,e.leftWindowKey=91,e.rightWindowKey=92,e.selectKey=93,e.numpad0=96,e.numpad1=97,e.numpad2=98,e.numpad3=99,e.numpad4=100,e.numpad5=101,e.numpad6=102,e.numpad7=103,e.numpad8=104,e.numpad9=105,e.multiply=106,e.add=107,e.subtract=109,e.decimalPoint=110,e.divide=111,e.f1=112,e.f2=113,e.f3=114,e.f4=115,e.f5=116,e.f6=117,e.f7=118,e.f8=119,e.f9=120,e.f10=121,e.f11=122,e.f12=123,e.numlock=144,e.scrolllock=145,e.semicolon=186,e.equalsign=187,e.comma=188,e.dash=189,e.period=190,e.forwardslash=191,e.graveAccent=192,e.openbracket=219,e.backslash=220,e.closebraket=221,e.singlequote=222,e}();e.KeyCode=t,e.KeyCodeKey=new Array(222);for(var n in t)e.KeyCodeKey[t[n]]=n}(e.helper||(e.helper={}))}(emloader||(emloader={}));!function(e){var t=function(t){function n(e){var n=t.call(this)||this;return n.module=e,n}return __extends(n,t),n.getKeyCode=function(t){return e.helper.KeyCode[t]},n.getKey=function(t){return e.helper.KeyCodeKey[t]},n.triggerKeyEvent=function(t,n,o,r){return e.Emloader.triggerEvent(t,n,{keyCode:o,witch:o,charCode:r})},n.prototype.pressKey=function(e){n.triggerKeyEvent(this.module,"keydown",e,0),this.emit(n.KEYPRESS,e)},n.prototype.releaseKey=function(e){n.triggerKeyEvent(this.module,"keyup",e,0),this.emit(n.KEYRELEASE,e)},n.KEYPRESS="keypress",n.KEYRELEASE="keyrelease",n}(e.event.EventEmiter);e.KeyHandler=t;var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.pressKey=function(e){this.emit(t.KEYPRESS,e)},n.prototype.releaseKey=function(e){this.emit(t.KEYRELEASE,e)},n}(e.event.EventEmiter);e.FakeKeyHandler=n}(emloader||(emloader={}));!function(e){!function(e){var t=function(){function e(){}return e.loadScript=function(e,t){return new Promise(function(n,o){var r=e.createElement("script");r.addEventListener("load",function(e){n(r)}),r.addEventListener("error",function(e){o(e)}),r.type="text/javascript",r.src=t,e.getElementsByTagName("head")[0].appendChild(r)})},e.createIframe=function(e){void 0===e&&(e=window.document);var t=e.createElement("iframe");return t.style.margin="0px",t.style.padding="0px",t.style.width="100%",t.style.height="100%",t.style.border="0px",t.style.overflow="hidden",t.setAttribute("scrolling","no"),t.frameBorder="0",t},e.getWindow=function(e){return e.ownerDocument.defaultView||e.ownerDocument.parentWindow},e.addClass=function(e,t){e.className=e.className+(-1===e.className.split(" ").indexOf(t)?" "+t:"")},e.removeClass=function(e,t){e.className=e.className.split(" ").filter(function(e){return e!==t}).join(" ")},e}();e.HTMLHelper=t}(e.helper||(e.helper={}))}(emloader||(emloader={}));!function(e){!function(e){var t=function(){function e(){}return e.loadFile=function(t,n,o){return e.fetchFile(t,"arraybuffer",o).then(function(e){return{name:n,data:new Uint8Array(e)}})},e.fetchFile=function(e,t,n){return new Promise(function(o,r){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType=t;var s="error loading "+e;n&&"function"==typeof n&&["progress","load","error","abort"].forEach(function(e){i.addEventListener(e,n)}),i.onload=function(e){i.status<200||i.status>=400?r(s+" : status code "+i.status):o(i.response)},i.onerror=function(e){r(s+" : "+e.toString())},i.send()})},e.toUint8Array=function(e){for(var t=e.length,n=new Uint8Array(t),o=0;o<t;o++)n[o]=e.charCodeAt(o);return n},e}();e.FileLoader=t}(e.helper||(e.helper={}))}(emloader||(emloader={}));!function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pressed={},t.sensibility=.5,t}return __extends(t,e),t.prototype.setControlMapping=function(e){this.controlMapping!==e&&(this.controlMapping=e,this.emit(t.CONTROLCHANGE))},t.prototype.getControlMapping=function(){return this.controlMapping},t.prototype.setKeyHandler=function(e){this.handler=e},t.prototype.getKeyHandler=function(){return this.handler},t.prototype.connect=function(e){var n=this;if(!this.isConnected()){this.gamepad=e;var o=function(){var e=n.getGamepad();t.axes.forEach(function(t,o){try{e.axes[o]<=-n.sensibility||e.axes[o]>=n.sensibility?n.keyPress(e.axes[o]<=-n.sensibility?t[0]:t[1]):(n.pressed[t[0]]||n.pressed[t[1]])&&n.keyRelease(n.pressed[t[0]]?t[0]:t[1])}catch(e){}}),n.getButtonMap().forEach(function(t,o){if(t)try{e.buttons[o].pressed?n.keyPress(t):n.pressed[t]&&n.keyRelease(t)}catch(e){}}),n.loopId=requestAnimationFrame(o)};o(),this.emit(t.CONNECTED)}},t.prototype.disconnect=function(){cancelAnimationFrame(this.loopId),this.loopId=null,this.gamepad=null,this.controlMapping=null,this.emit(t.DISCONNECTED)},t.prototype.isConnected=function(){return!!this.loopId},t.prototype.getGamepad=function(){return this.gamepad?navigator.getGamepads()[this.gamepad.index]:null},t.prototype.getButtonMap=function(){return this.customButtonMap||t.buttonMap},t.prototype.setButtonMap=function(e){e!==this.customButtonMap&&(this.customButtonMap=e,this.emit(t.BUTTONMAPCHANGE))},t.prototype.keyPress=function(e){this.handler&&(this.pressed[e]=!0,this.handler.pressKey(this.controlMapping[e]))},t.prototype.keyRelease=function(e){this.handler&&(this.pressed[e]=!1,this.handler.releaseKey(this.controlMapping[e]))},t.axes=[["left","right"],["up","down"]],t.buttonMap=["button1","button2","button3","button4","button5","button6",null,null,"coin","start"],t.BUTTONMAPCHANGE="buttonmapchange",t.DISCONNECTED="disconnected",t.CONNECTED="connected",t.CONTROLCHANGE="controlchange",t}(e.event.EventEmiter);e.Joystick=t}(emloader||(emloader={}));!function(e){var t=function(){function e(){this.keyCodeMapping=[]}return e.prototype.setKeyHandler=function(e){this.keyhandler=e},e.prototype.bind=function(){var e=this;this.unbind(),this.keyboardEventHandler=function(t){var n=e.keyCodeMapping[t.keyCode]||t.keyCode;n&&("keydown"===t.type?e.keyhandler.pressKey(n):e.keyhandler.releaseKey(n))},document.addEventListener("keyup",this.keyboardEventHandler),document.addEventListener("keydown",this.keyboardEventHandler)},e.prototype.unbind=function(){this.keyboardEventHandler&&(document.removeEventListener("keyup",this.keyboardEventHandler),document.removeEventListener("keydown",this.keyboardEventHandler),this.keyboardEventHandler=null)},e.KEYMAPPINGCHANGE="keymappingchange",e}();e.Keyboard=t}(emloader||(emloader={}));!function(e){var t=function(t){function n(o){var r=t.call(this)||this;r.mappings=o,r.keyboard=new e.Keyboard,r._joysticks=new Array(4);for(var i=0;i<4;i++)r._joysticks[i]=function(){var t=new e.Joystick;return t.on(e.Joystick.CONNECTED,function(){return r.emit(n.JOYSTICKCONNECTED,t)}),t.on(e.Joystick.DISCONNECTED,function(){return r.emit(n.JOYSTICKDISCONNECTED,t)}),t.on(e.Joystick.BUTTONMAPCHANGE,function(){return r.emit(n.JOYSTICKBUTTONMAPCHANGE,t)}),t.on(e.Joystick.CONTROLCHANGE,function(){r.emit(n.JOYSTICKCONTROLCHANGE,t),r.getJoysticks().forEach(function(e){e!==t&&e.getControlMapping()===t.getControlMapping()&&e.setControlMapping(r.getAvailableMappings()[0])})}),t}();return r}return __extends(n,t),n.prototype.setKeyHandler=function(e){var t=this;this.keyHandler=e,this.keyHandler.on("keypress",function(e){return t.emit(n.KEYPRESS,e)}),this.keyHandler.on("keyrelease",function(e){return t.emit(n.KEYRELEASE,e)}),this.getJoysticks().forEach(function(t){t&&t.setKeyHandler(e)}),this.keyboard.setKeyHandler(e)},n.prototype.getKeyHandler=function(){return this.keyHandler},n.prototype.getJoysticks=function(){return this._joysticks.filter(function(e){return e.isConnected()})},n.prototype.getJoystick=function(e){return this._joysticks.filter(function(t){return t&&t.getControlMapping()===e})[0]},n.prototype.getAvailableMappings=function(){var e=this;return this.mappings.filter(function(t){return!e.getJoystick(t)})},n.prototype.checkGamepads=function(){for(var e=navigator.getGamepads(),t=0,n=e.length;t<n;t++)e[t]&&!this._joysticks[t].isConnected()?(this._joysticks[t].setControlMapping(this.getAvailableMappings()[0]),this._joysticks[t].setKeyHandler(this.keyHandler),this._joysticks[t].connect(e[t])):!e[t]&&this._joysticks[t].isConnected()&&this._joysticks[t].disconnect()},n.prototype.bind=function(e){var t=this;void 0===e&&(e=window),this.unbind(e),this.gamepadChecker=setInterval(function(){t.checkGamepads()},1e3),this.checkGamepads(),this.keyboard.bind()},n.prototype.unbind=function(e){void 0===e&&(e=window),this.gamepadChecker&&(clearInterval(this.gamepadChecker),this.getJoysticks().forEach(function(e){e.disconnect()})),this.keyboard.unbind()},n.JOYSTICKCONNECTED="joystickconnected",n.JOYSTICKDISCONNECTED="joystickdisconnected",n.JOYSTICKBUTTONMAPCHANGE="joystickbuttonmapchange",n.JOYSTICKCONTROLCHANGE="joystickcontrolchange",n.KEYPRESS="keypress",n.KEYRELEASE="keyrelease",n}(e.event.EventEmiter);e.Controllers=t}(emloader||(emloader={}));!function(e){!function(e){var t=function(){function e(e,t){var n=this;this.controllers=e,this.keyCode=t,this.element=document.createElement("button"),this.element.appendChild(document.createElement("span")),this.element.addEventListener("mousedown",function(e){return n.controllers.getKeyHandler().pressKey(t)}),this.element.addEventListener("mouseup",function(e){return n.controllers.getKeyHandler().releaseKey(t)}),this.element.addEventListener("touchstart",function(e){n.controllers.getKeyHandler().pressKey(t)}),this.element.addEventListener("touchend",function(e){n.controllers.getKeyHandler().releaseKey(t)})}return e.prototype.getElement=function(){return this.element},e.prototype.setValue=function(e){this.element.getElementsByTagName("span")[0].innerHTML=e},e}();e.ControllerButton=t}(e.plugins||(e.plugins={}))}(emloader||(emloader={}));!function(e){!function(t){var n=function(){function t(t,n,o){var r=this;this.controllers=t,this.mapping=n,this.onChange=o,this.baseClass="emloader-control-selector",this.mainContainer=document.createElement("div"),this.mainContainer.className=this.baseClass,this.setJoystick(t.getJoystick(n)),t.on(e.Controllers.JOYSTICKCONNECTED,function(e){r.setJoystick(e.getControlMapping()===n?e:r.joystick)}),t.on(e.Controllers.JOYSTICKDISCONNECTED,function(e){r.setJoystick(r.joystick&&!r.joystick.isConnected()?null:r.joystick)}),t.on(e.Controllers.JOYSTICKCONTROLCHANGE,function(e){e===r.joystick&&e.getControlMapping()!==n?r.setJoystick(null):e!==r.joystick&&e.getControlMapping()===n?r.setJoystick(e):r.setJoystick(r.joystick)})}return t.prototype.getElement=function(){return this.mainContainer},t.prototype.setJoystick=function(e){void 0===e&&(e=null),e!==this.joystick&&e&&e.getControlMapping()!==this.mapping&&e.setControlMapping(this.mapping),this.joystick=e,this.empty(),this.mainContainer.appendChild(this.createOption(this.joystick,!0)),"function"==typeof this.onChange&&this.onChange(e)},t.prototype.open=function(){var t=this;if(!this.isOpened()){var n=function(e){void 0===e&&(e=null);var n=t.createOption(e);n.addEventListener("click",function(n){t.setJoystick(e)}),t.mainContainer.appendChild(n)};this.controllers.getJoysticks().forEach(function(e){e&&e!==t.joystick&&n(e)}),this.joystick&&n(),e.helper.HTMLHelper.addClass(this.mainContainer.childNodes[0],this.baseClass+"-expanded")}},t.prototype.close=function(){this.setJoystick(this.joystick)},t.prototype.isOpened=function(){return this.mainContainer.childNodes.length>1},t.prototype.empty=function(){for(;this.mainContainer.hasChildNodes();)this.mainContainer.removeChild(this.mainContainer.lastChild)},t.prototype.createOption=function(t,n){var o=this;void 0===t&&(t=null);var r=document.createElement("div");return r.className=this.baseClass+"-item "+this.baseClass+"-"+(t?"gamepad":"keyboard"),r.innerHTML=t&&t.getGamepad()?String(t.getGamepad().index+1):"",n&&this.controllers.getJoysticks().length>0&&(e.helper.HTMLHelper.addClass(r,this.baseClass+"-expandable"),r.addEventListener("click",function(e){o.isOpened()?o.close():o.open()})),r},t}();t.ControllerSelector=n}(e.plugins||(e.plugins={}))}(emloader||(emloader={}));!function(e){!function(t){var n=function(){function n(n,o){var r=this;this.controllers=n,this.mapping=o,this.buttons=new Array(222),this.baseClass="emloader-virtual-controller",this.keyCodeId=new Array(222),this.mainContainer=document.createElement("div"),this.mainContainer.className=this.baseClass,this.setJoystick(n.getJoystick(o));for(var i in o){var s=o[i];this.buttons[s]=new t.ControllerButton(n,s),this.keyCodeId[s]=i,this.mainContainer.appendChild(this.buttons[s].getElement())}this.selector=new t.ControllerSelector(n,o,function(e){r.setJoystick(e)}),this.mainContainer.appendChild(this.selector.getElement()),this.updateButtons(),this.controllers.on(e.Controllers.KEYPRESS,function(t){return r.onKeyEvent(e.Controllers.KEYPRESS,t)}),this.controllers.on(e.Controllers.KEYRELEASE,function(t){return r.onKeyEvent(e.Controllers.KEYRELEASE,t)})}return n.prototype.getElement=function(){return this.mainContainer},n.prototype.setKeyHandler=function(e){this.keyHandler=e},n.prototype.getKeyHandler=function(){return this.keyHandler},n.prototype.setJoystick=function(e){this.joystick=e,this.updateButtons()},n.prototype.updateButtons=function(){for(var e in this.buttons)this.updateButton(this.buttons[e],this.keyCodeId[e])},n.prototype.updateButton=function(t,n){var o=e.KeyHandler.getKey(this.mapping[n]),r=this.baseClass+"-button",i=[r,r+"-"+o,r+"-"+n];switch(this.joystick&&i.push(r+"-gamepad"),t.getElement().className=i.join(" "),n){case"coin":case"start":t.setValue(n.replace("coin","insert coin")+" ("+o.replace("digit","")+")");break;default:t.setValue(this.joystick?n.replace("button",""):o)}},n.prototype.onKeyEvent=function(t,n){this.buttons[n]&&e.helper.HTMLHelper[(t===e.Controllers.KEYPRESS?"add":"remove")+"Class"](this.buttons[n].getElement(),this.baseClass+"-button-pressed")},n}();t.VirtualController=n}(e.plugins||(e.plugins={}))}(emloader||(emloader={}));var emloader;!function(e){function t(t,o,r){(r=r||{}).locateFile=r.locateFile||function(e){return".mem"===e.substr(-4)?t+".mem":e};var i=new n(o,r);return e.helper.HTMLHelper.loadScript(i.scope.document,t).then(function(){return i})}e.load=t,e.loadHeadless=function(e,n){var o=document.createElement("div");return o.style.display="none",document.body.appendChild(o),t(e,o,n)};var n=function(t){function n(o,r){var i=t.call(this)||this;i._container=o,i._stdout=[],i._stderr=[],i._files=[],i._iframe=e.helper.HTMLHelper.createIframe(e.helper.HTMLHelper.getWindow(i._container).document),i._container.appendChild(i._iframe);var s="width:100%;height:100%;";["-moz-crisp-edges","-o-crisp-edges","-webkit-optimize-contrast","optimize-contrast","crisp-edges","pixelated","optimizeSpeed"].forEach(function(e){s+="image-rendering:"+e+";"}),i._iframe.contentWindow.document.write("<!doctype html><html><head><style>canvas {"+s+'}</style></head><body style="margin:0px;padding:0px"><canvas/></body></html>'),i._iframe.contentWindow.document.close(),i._scope=i._iframe.contentWindow,i._canvas=i._scope.document.getElementsByTagName("canvas")[0],i._scope.Module={};for(var a in r)r.hasOwnProperty(a)&&(i._scope.Module[a]=r[a]);return i._scope.Module.arguments=r.arguments||[],i._scope.Module.screenIsReadOnly=r.screenIsReadOnly||!1,i._scope.Module.print=function(e){i._stdout.push(e),"function"==typeof r.print&&r.print(e),i.emit(n.ON_STDOUT,e)},i._scope.Module.printErr=function(e){i._stderr.push(e),"function"==typeof r.printErr&&r.printErr(e),i.emit(n.ON_STDERROR,e)},i._scope.Module.canvas=i.canvas,i._scope.Module.noInitialRun=r.noInitialRun||!0,i._keyHandler=new e.KeyHandler(i.module),i}return __extends(n,t),n.triggerEvent=function(t,n,o){void 0===o&&(o={});var r=e.helper.HTMLHelper.getWindow(t.canvas),i=r.document.createEventObject?r.document.createEventObject():r.document.createEvent("Events");i.initEvent&&i.initEvent(n,!0,!0);for(var s in o)o.hasOwnProperty(s)&&void 0===i[s]&&(i[s]=o[s]);t.canvas.dispatchEvent?t.canvas.dispatchEvent(i):t.canvas.fireEvent("on"+n,i)},Object.defineProperty(n.prototype,"keyHandler",{get:function(){return this._keyHandler},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scope",{get:function(){return this._scope},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"module",{get:function(){return this.scope.Module},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"stdout",{get:function(){return this._stdout},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"stderr",{get:function(){return this._stderr},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"files",{get:function(){return this._files},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"FS",{get:function(){return this.scope.FS},enumerable:!0,configurable:!0}),n.prototype.run=function(e){return Promise.resolve(this.module.callMain(e))},n.prototype.addFS=function(e,t){this.FS.mount(t||this.scope.MEMFS,{root:"/"},e)},n.prototype.addFile=function(e,t){this.FS.writeFile(t+"/"+e.name,e.data,{encoding:"binary"}),this._files.push(e)},n.prototype.loadFile=function(t,n,o,r){var i=this;return e.helper.FileLoader.loadFile(t,n,r).then(function(e){return i.addFile(e,o)})},n.prototype.loadFiles=function(e,t,n){var o=this;return Promise.all(Object.keys(e).map(function(r){return o.loadFile(e[r],r,t,n)})).then(function(){return Promise.resolve()})},n.ON_STDERROR="onstderror",n.ON_STDOUT="onstdout",n}(e.event.EventEmiter);e.Emloader=n}(emloader||(emloader={}));var mp3gain;!function(e){e.ON_STDERROR="onstderror",e.ON_STDOUT="onstdout",e.mp3Path="/mp3";var t=function(t){function n(e){var n=t.call(this)||this;return n.binpath=e,n.files=[],n}return __extends(n,t),n.prototype.addFile=function(e){var t=this;return"string"==typeof e?emloader.helper.FileLoader.loadFile(e,e.split("/").reverse()[0]).then(function(e){return t.files.push(e),e}):(this.files.push(e),Promise.resolve(e))},n.prototype.addFiles=function(e){var t=this;return Promise.all(e.map(function(e){return t.addFile(e)}))},n.prototype.removeFile=function(e){var t=this.files.indexOf(e);return t>-1&&(this.files.splice(t,1),!0)},n.prototype.removeFiles=function(){return this.files.splice(0,this.files.length)},n.prototype.getFiles=function(){return this.files},n.prototype.run=function(e){return window.Worker?this.runAsWorker(e):this.runWithEmloader(e)},n.prototype.runWithEmloader=function(t){var n=this;return emloader.loadHeadless(this.binpath).then(function(o){var r=Array.isArray(t)?t:t.trim().split(" ");return o.FS.mkdir(e.mp3Path),n.files.forEach(function(t){o.addFile(t,e.mp3Path),r.push(e.mp3Path+"/"+t.name)}),o.on(emloader.Emloader.ON_STDOUT,function(t){n.emit(e.ON_STDOUT,t)}),o.on(emloader.Emloader.ON_STDERROR,function(t){n.emit(e.ON_STDERROR,t)}),o.run(r).then(function(){return o.FS.readdir(e.mp3Path).filter(function(e){return!!n.files.find(function(t){return t.name===e})}).map(function(t){return{name:t,data:o.FS.readFile(e.mp3Path+"/"+t,{encoding:"binary"})}})})})},n.prototype.runAsWorker=function(t){var n=this;return new Promise(function(o,r){var i=new Worker(n.binpath);i.onmessage=function(t){Array.isArray(t.data)?(i.terminate(),o(t.data)):n.emit(t.data.stderr?e.ON_STDERROR:e.ON_STDOUT,t.data.stderr||t.data.stdout)},i.postMessage({binpath:n.binpath,files:n.files,arguments:"string"==typeof t?t.trim().split(" "):t})})},n}(emloader.event.EventEmiter);e.MP3GainWrapper=t}(mp3gain||(mp3gain={}));